version: v2beta1

commands:
  tests: |-
    CI_SERVER_HOST= devspace --silent run ensure-py-deps tests/api
    pdm run -p tests/api pytest -rpf "$@"

  tests_update_models: |-
    export CI_SERVER_HOST=
    devspace --silent run gen_py_openapi_models \
      docs/api/dss-target-service-schema.yaml \
      tests/api/integration/models/http_api.py \
      "DDS Provider"
    devspace --silent run gen_py_asyncapi_models \
      docs/api/dss-target-service-ws.yaml \
      tests/api/integration/models/ws_api.py \
      "DDS Provider"
